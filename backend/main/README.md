# бекенд галереи

## соглашения

- именование роутов происходит от имени методов:
    - метод: `addCard`, роут: `add-card`
    - метод: `repeatSendCode`, роут: `repeat-send-code`

однако, если есть ряд методов типа `add-card`, `update-card`, `delete-card`, `get-card-info`
и так далее, то вступает в силу правило группировки и использования типов http-запросов:

```
POST card/add
PUT card/update/{id}
DELETE card/{id}
GET card/info/{id}
```

## коды ошибок api

список ошибок и генерирующих их исключений
https://track.webregul.ru/youtrack/articles/HDGL-A-4/

## документация api

пишем документацию к методам api и моделям в формате swagger. спецификация формата
автодокументации [по ссылке](https://swagger.io/specification/). точно задокументированы контроллеры `Controller` (
базовые схемы) `AuthController` (методы) - используем их в качестве примера.

документация генерируется автоматически при установке композера. для перегенерации документации требуется выполнить
команду `php artisan swagger-lume:generate`.

- документация в челокочитаемом и пригодном для тестирования виде лежит по роуту `/api/docs`
- документация в формате json лежит по роуту `/docs`

обратите внимание: если `APP_ENV != local`, для просмотра документации к роутам нужно
добавлять `?token={SWAGGER_DOCS_TOKEN from .env}`

документация по роуту `/api/docs` поддерживает JWT-Bearer-аутентификацию:
иконока замочка справа от названия метода или кнопка "Authorize" справа вверху. так или иначе вводим туда полученый при
аутентификации или верификации токен и тестируем методы, требующие аутентификации, без указания токена.

## сидеры

у проекта есть сидеры, без выполнения которых база будет неполной. 
это может выразиться при регистрации в сообщении `Trying to get property 'id' of non-object`

делаем `docker-compose exec app sh -c 'cd backend && php artisan db:seed --class=TariffsSeeder'`
